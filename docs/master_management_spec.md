# マスター管理機能 設計書

## 1. 概要
本ドキュメントは、在庫管理システムに新しく追加する「マスター管理機能」の設計について記述する。
この機能は、システムの基本データとなる各種マスター（部品、製品・BOM、ユーザー）を一元的に管理することを目的とする。

## 2. 画面構成
- **URL:** `/master`
- **画面構成:** 1つの親ページと、3つのタブで各マスター管理機能を切り替える構成とする。
  - **タブ1:** 部品マスター
  - **タブ2:** 製品・BOMマスター
  - **タブ3:** ユーザーマスター

## 3. 共通仕様
- 各マスターの一覧はテーブル形式で表示する。
- 一覧にはページネーションを実装する。
- 各一覧の上部には、検索フィルターと「新規登録」ボタンを配置する。
- 各行には「編集」および「有効/無効切り替え」のアクションボタンを配置する。
- 新規登録と編集はモーダルウィンドウ内で行う。

---

## 4. 各タブの仕様

### 4.1. 部品マスター (Parts Master)
部品の基本情報を管理する。

- **機能一覧:**
  - 部品一覧表示
  - 部品検索
  - 部品新規登録
  - 部品情報編集
  - 部品の有効/無効切り替え

- **一覧表示項目:**
  - `part_code` (部品コード)
  - `specification` (規格・仕様)
  - `category` (カテゴリ)
  - `supplier` (主要仕入先)
  - `unit_price` (単価)
  - `lead_time_days` (リードタイム)
  - `safety_stock` (安全在庫数)
  - `is_active` (状態)

- **検索フィルター項目:**
  - `part_code` (部品コード)
  - `specification` (規格・仕様)
  - `category` (カテゴリ)
  - `supplier` (仕入先)

- **登録・編集項目:**
  - `part_code` (部品コード): [登録時のみ、編集不可]
  - `specification` (規格・仕様)
  - `unit` (単位)
  - `lead_time_days` (調達リードタイム)
  - `safety_stock` (安全在庫数)
  - `supplier` (主要仕入先)
  - `category` (部品カテゴリ): [将来的には `part_categories` からの選択式]
  - `unit_price` (単価)
  - `remarks` (備考)
  - `is_active` (有効/無効)

### 4.2. 製品・BOMマスター (Product & BOM Master)
製品情報と、その製品を構成する部品（BOM）を管理する。

- **画面構成:**
  - 左側に製品一覧を表示する。
  - 製品一覧から特定の製品を選択すると、右側にその製品の「基本情報」と「BOM情報」を表示する。

- **機能一覧:**
  - **製品:**
    - 製品一覧表示
    - 製品検索
    - 製品新規登録
    - 製品情報編集
    - 製品の有効/無効切り替え
  - **BOM:**
    - 選択された製品のBOM一覧表示
    - BOMへの部品追加
    - BOMの部品情報（使用数量など）編集
    - BOMからの部品削除

- **製品一覧表示項目:**
  - `product_code` (製品コード)
  - `remarks` (備考)
  - `is_active` (状態)

- **製品の登録・編集項目:**
  - `product_code` (製品コード): [登録時のみ、編集不可]
  - `remarks` (備考)
  - `is_active` (有効/無効)

- **BOM一覧表示項目:**
  - `station_code` (作業場コード)
  - `part_code` (部品コード)
  - `specification` (部品の規格・仕様)
  - `quantity` (使用数量)
  - `remarks` (備考)

- **BOMの登録・編集項目:**
  - `station_code` (作業場コード): [`work_stations` テーブルから選択]
  - `part_code` (部品コード): [部品マスターからの選択式]
  - `quantity` (使用数量)
  - `remarks` (備考)

### 4.3. ユーザーマスター (User Master)
システムを利用するユーザーのアカウントと権限を管理する。

- **機能一覧:**
  - ユーザー一覧表示
  - ユーザー検索
  - ユーザー新規登録
  - ユーザー情報編集
  - ユーザーの有効/無効切り替え

- **一覧表示項目:**
  - `username` (ユーザー名)
  - `email` (メールアドレス)
  - `role` (権限レベル)
  - `is_active` (状態)
  - `last_login_at` (最終ログイン日時)

- **検索フィルター項目:**
  - `username` (ユーザー名)
  - `email` (メールアドレス)
  - `role` (権限レベル)

- **登録・編集項目:**
  - `username` (ユーザー名)
  - `email` (メールアドレス)
  - `password` (パスワード): [登録時のみ設定]
  - `role` (権限レベル): [ドロップダウン選択: `admin`, `production_manager`, `material_staff`, `viewer`]
  - `is_active` (有効/無効)
  - ※編集時にはパスワードリセット機能を提供することが望ましい。
