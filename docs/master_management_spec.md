# マスター管理機能 設計書

## 1. 概要
本ドキュメントは、在庫管理システムに新しく追加する「マスター管理機能」の設計について記述する。
この機能は、システムの基本データとなる各種マスター（部品、製品、作業場所、BOM、ユーザー）を一元的に管理することを目的とする。

## 2. 画面構成
- **URL:** `/master`
- **画面構成:** 1つの親ページと、6つの子ページで各マスター管理機能を提供する。
  - **ページ1:** 部品マスター (`/master/parts`)
  - **ページ2:** 製品マスター (`/master/products`)
  - **ページ3:** 作業場所マスター (`/master/stations`)
  - **ページ4:** BOMマスター (`/master/bom`)
  - **ページ5:** ユーザーマスター (`/master/users`)
  - **ページ6:** 部品カテゴリーマスター (`/master/categories`)

### 2.1. ナビゲーションUI仕様
各マスターページには専用のナビゲーションヘッダー（タブUI）を配置し、ページ間の移動を容易にする。

#### ナビゲーションヘッダー仕様
- **配置位置:** ヘッダーのドロップダウンメニューに加えて、各マスターページ内にタブ形式のナビゲーションを配置
- **表示形式:** 水平タブレイアウト
- **タブ項目:**
  - 部品マスター
  - カテゴリマスター
  - 製品マスター
  - 作業場所マスター
  - BOMマスター
  - ユーザーマスター
- **アクティブ状態:** 現在表示中のページのタブをハイライト表示
- **権限制御:** ユーザーの権限に応じてタブの表示/非表示を制御

## 3. 共通仕様
- 各マスターの一覧はテーブル形式で表示する。
- 一覧にはページネーションを実装する。
- 各一覧の上部には、検索フィルターと「新規登録」ボタンを配置する。
- 各行には「編集」および「有効/無効切り替え」のアクションボタンを配置する。
- 新規登録と編集はモーダルウィンドウ内で行う。

---

## 4. 各ページの仕様

### 4.1. 部品マスター (Parts Master)
部品の基本情報を管理する。
- **機能:** 一覧表示, 検索, 新規登録, 編集, 有効/無効切り替え
- **主要項目:** `part_code`, `specification`, `category`, `supplier`, `unit_price`, `lead_time_days`, `safety_stock`, `is_active`

### 4.2. 製品マスター (Product Master)
製品の基本情報を管理する。
- **機能:** 一覧表示, 検索, 新規登録, 編集, 有効/無効切り替え
- **一覧表示項目:**
  - `product_code` (製品コード)
  - `remarks` (備考)
  - `is_active` (状態)
- **登録・編集項目:**
  - `product_code` (製品コード): [登録時のみ、編集不可]
  - `remarks` (備考)
  - `is_active` (有効/無効)

### 4.3. 作業場所マスター (Station Master)
作業場所の情報を管理する。
- **機能:** 一覧表示, 検索, 新規登録, 編集, 有効/無効切り替え
- **一覧表示項目:**
  - `station_code` (作業場所コード)
  - `station_name` (作業場所名)
  - `remarks` (備考)
  - `is_active` (状態)
- **登録・編集項目:**
  - `station_code` (作業場所コード): [登録時のみ、編集不可]
  - `station_name` (作業場所名)
  - `remarks` (備考)
  - `is_active` (有効/無効)

### 4.4. BOMマスター (Bill of Materials Master)
製品と作業場所、使用部品を関連付けるBOM（部品構成表）を管理する。
- **データ構造**: 製品 → 複数の作業場所 → 作業場所につき複数の部品
- **画面構成:**
  1.  最初に製品を選択する。
  2.  選択した製品に紐づく作業場所の一覧が表示される。ここで製品に対する作業場所の追加・削除が可能。
  3.  作業場所を選択すると、その作業場所で使用する部品の一覧が表示される。ここで部品の追加・削除・使用数量の編集が可能。
- **機能一覧:**
  - **製品選択:** BOMを管理したい製品を選択する。
  - **作業場所の関連付け:** 製品に作業場所を紐づける。
  - **部品の関連付け:** 製品の特定の作業場所で使用する部品と数量を紐づける。
- **BOM一覧表示項目（部品レベル）:**
  - `part_code` (部品コード)
  - `specification` (部品の規格・仕様)
  - `quantity` (使用数量)
  - `remarks` (備考)
- **BOMの登録・編集項目:**
  - `product_code` (対象製品)
  - `station_code` (対象作業場所)
  - `part_code` (使用部品): [部品マスターからの選択式]
  - `quantity` (使用数量)
  - `remarks` (備考)

### 4.5. ユーザーマスター (User Master)
システムを利用するユーザーのアカウントと権限を管理する。
- **機能:** 一覧表示, 検索, 新規登録, 編集, 有効/無効切り替え
- **主要項目:** `username`, `email`, `role`, `is_active`, `last_login_at`

### 4.6. 部品カテゴリーマスター (Parts Category Master)
部品の分類を管理するカテゴリーマスター。部品マスターで使用されるカテゴリーの基準を定義する。
- **機能:** 一覧表示, 検索, 新規登録, 編集, 削除, 有効/無効切り替え
- **一覧表示項目:**
  - `category_code` (カテゴリーコード)
  - `category_name` (カテゴリー名)
  - `is_active` (状態)
- **登録・編集項目:**
  - `category_code` (カテゴリーコード): [登録時のみ、編集不可]
  - `category_name` (カテゴリー名)
  - `is_active` (有効/無効)
- **注意事項:**
  - 現在はプレースホルダとして実装
  - 部品一覧等での表示は`category_name`を使用
  - 将来的に部品マスターとの関連付け機能を拡張予定