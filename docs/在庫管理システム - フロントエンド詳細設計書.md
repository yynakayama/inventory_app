# åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è©³ç´°è¨­è¨ˆæ›¸ (2025/09/12 æ›´æ–°ç‰ˆ)

## ğŸ¯ è¨­è¨ˆæ¦‚è¦

### ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“åƒ
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Node.js + Express + MySQLï¼ˆå®Œæˆæ¸ˆã¿ï¼‰
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js (App Router) + React + TypeScript
- **API**: JWTèªè¨¼ + 4æ®µéšæ¨©é™ç®¡ç†
- **Dockerç’°å¢ƒ**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆãƒãƒ¼ãƒˆ3001ï¼‰ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆãƒãƒ¼ãƒˆ3000ï¼‰

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **Framework**: Next.js (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **State Management**: React Context API (èªè¨¼), `useState`, `useEffect` (ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹)
- **API Client**: `fetch` API
- **Permissions**: Custom Hooks (`useProductionPermissions`)

---

## ğŸ“‚ ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆè¨­è¨ˆ (ç¾çŠ¶ãƒ™ãƒ¼ã‚¹)

```
src/
â”œâ”€â”€ app/                         # App Router
â”‚   â”œâ”€â”€ (auth)/login/page.tsx   # ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
â”‚   â”œâ”€â”€ api/health/route.ts     # ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯API
â”‚   â”œâ”€â”€ dashboard/page.tsx      # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢
â”‚   â”œâ”€â”€ inventory/page.tsx      # åœ¨åº«ç®¡ç†ç”»é¢
â”‚   â”œâ”€â”€ procurement/page.tsx    # èª¿é”ç®¡ç†ç”»é¢
â”‚   â”œâ”€â”€ production/page.tsx     # ç”Ÿç”£è¨ˆç”»ç”»é¢
â”‚   â”œâ”€â”€ layout.tsx              # å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”œâ”€â”€ page.tsx                # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ globals.css             # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
â”œâ”€â”€ components/                # å†åˆ©ç”¨å¯èƒ½ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ AlertCard.tsx
â”‚   â”‚   â””â”€â”€ KPICard.tsx
â”‚   â”œâ”€â”€ guards/
â”‚   â”‚   â”œâ”€â”€ PermissionGuard.tsx # UIãƒ¬ãƒ™ãƒ«ã®æ¨©é™åˆ¶å¾¡
â”‚   â”‚   â””â”€â”€ RouteGuard.tsx      # ãƒšãƒ¼ã‚¸ãƒ¬ãƒ™ãƒ«ã®æ¨©é™åˆ¶å¾¡
â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”œâ”€â”€ ClientLayoutWrapper.tsx
â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â””â”€â”€ MainLayout.tsx
â”‚   â”œâ”€â”€ procurement/
â”‚   â”‚   â”œâ”€â”€ SearchFilters.tsx
â”‚   â”‚   â””â”€â”€ StatusBadge.tsx
â”‚   â”œâ”€â”€ production/
â”‚   â”‚   â”œâ”€â”€ ProductionPlanForm.tsx
â”‚   â”‚   â”œâ”€â”€ SearchFilters.tsx
â”‚   â”‚   â””â”€â”€ StatusBadge.tsx
â”‚   â””â”€â”€ ui/
â”‚       â”œâ”€â”€ Button.tsx
â”‚       â”œâ”€â”€ Modal.tsx
â”‚       â””â”€â”€ PartCodeSelector.tsx
â”œâ”€â”€ hooks/                     # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â””â”€â”€ useProductionPermissions.ts # ç”Ÿç”£è¨ˆç”»ç”»é¢ã®æ¨©é™ç®¡ç†
â”œâ”€â”€ lib/                       # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»è¨­å®š
â”‚   â”œâ”€â”€ api.ts                 # APIåŸºæœ¬è¨­å®š (ç¾çŠ¶ã¯æœªä½¿ç”¨)
â”‚   â””â”€â”€ utils.ts               # æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ (cné–¢æ•°ãªã©)
â”œâ”€â”€ providers/                 # Provider
â”‚   â””â”€â”€ AuthProvider.tsx       # èªè¨¼çŠ¶æ…‹ç®¡ç†
â”œâ”€â”€ types/                     # TypeScriptå‹å®šç¾©
â”‚   â”œâ”€â”€ procurement.ts         # èª¿é”é–¢é€£ã®å‹
â”‚   â””â”€â”€ production.ts          # ç”Ÿç”£é–¢é€£ã®å‹
â””â”€â”€ utils/                     # ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
    â””â”€â”€ tableRowColors.ts      # ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œã®è‰²åˆ†ã‘
```

---

## ğŸ” èªè¨¼ãƒ»æ¨©é™è¨­è¨ˆ

### æ¨©é™ãƒ¬ãƒ™ãƒ«å®šç¾©
- `admin`: å…¨æ¨©é™
- `production_manager`: ç”Ÿç”£ã€åœ¨åº«é–²è¦§
- `material_staff`: åœ¨åº«ã€èª¿é”
- `viewer`: é–²è¦§ã®ã¿

### æ¨©é™åˆ¶å¾¡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **`RouteGuard.tsx`**: ãƒšãƒ¼ã‚¸å˜ä½ã§ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã€‚æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚„æ¨©é™ã®ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã€‚
- **`PermissionGuard.tsx`**: ãƒœã‚¿ãƒ³ã‚„ãƒ•ã‚©ãƒ¼ãƒ ãªã©ã€UIè¦ç´ å˜ä½ã§ã®è¡¨ç¤ºãƒ»éè¡¨ç¤ºã‚’åˆ¶å¾¡ã™ã‚‹ã€‚

---

## ğŸ“¡ APIé€£æºè¨­è¨ˆ

### åŸºæœ¬æ–¹é‡
- å„ãƒšãƒ¼ã‚¸ã®`useEffect`å†…ã§`fetch` APIã‚’ç›´æ¥ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’è¡Œã†ã€‚
- èªè¨¼ãŒå¿…è¦ãªAPIã«ã¯ã€`localStorage`ã‹ã‚‰å–å¾—ã—ãŸJWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’`Authorization`ãƒ˜ãƒƒãƒ€ãƒ¼ã«ä»˜ä¸ã™ã‚‹ã€‚
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§`try-catch`ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦å®Ÿè£…ã€‚

### ä¸»è¦APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- **Dashboard**: `GET /api/reports/dashboard`
- **Inventory**: `GET /api/inventory`, `POST /api/inventory/:part_code/receipt`, `POST /api/inventory/:part_code/issue`, `POST /api/stocktaking/execute`
- **Procurement**: `GET /api/scheduled-receipts`, `POST /api/scheduled-receipts`, `PUT /api/scheduled-receipts/:id/delivery-response`, `POST /api/inventory/:part_code/integrated-receipt`
- **Production**: `GET /api/plans`, `POST /api/plans`, `POST /api/plans/:id/requirements`, `POST /api/plans/:id/start-production`

---

## ğŸš€ é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºè¨ˆç”» (æ›´æ–°ç‰ˆ)

### Phase 1: èªè¨¼ãƒ»åŸºç›¤ï¼ˆå®Œäº†ï¼‰
- [x] èªè¨¼ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£… (ãƒ­ã‚°ã‚¤ãƒ³ã€æ¨©é™åˆ¶å¾¡)
- [x] å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå®Ÿè£…
- [x] åŸºæœ¬UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£… (Button, Modal)

### Phase 2: ä¸»è¦æ©Ÿèƒ½å®Ÿè£…ï¼ˆå®Œäº†ï¼‰
- [x] ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢
- [x] åœ¨åº«ç®¡ç†ç”»é¢ (ä¸€è¦§ã€è©³ç´°ã€èª¿æ•´ã€æ£šå¸)
- [x] èª¿é”ç®¡ç†ç”»é¢ (ä¸€è¦§ã€ç™ºæ³¨ã€ç´æœŸå›ç­”ã€å…¥è·)
- [x] ç”Ÿç”£è¨ˆç”»ç”»é¢ (ä¸€è¦§ã€ä½œæˆã€æ‰€è¦é‡è¨ˆç®—ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°)

### Phase 3: ãƒã‚¹ã‚¿ç®¡ç†ï¼ˆæœ€çµ‚ãƒ•ã‚§ãƒ¼ã‚ºï¼‰
- [ ] éƒ¨å“ãƒã‚¹ã‚¿ç®¡ç†ç”»é¢
- [ ] è£½å“ãƒã‚¹ã‚¿ãƒ»BOMç®¡ç†ç”»é¢
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢ (ç®¡ç†è€…å‘ã‘)

### Phase 4: ãƒ†ã‚¹ãƒˆãƒ»æœ€é©åŒ–
- [ ] å˜ä½“ãƒ»çµåˆãƒ†ã‚¹ãƒˆã®å®Ÿè£…
- [ ] E2Eãƒ†ã‚¹ãƒˆã®å®Ÿè£…
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### å°†æ¥æ‹¡å¼µ
- [ ] ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½

---